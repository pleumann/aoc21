#program day09  10 RUN AT 3  20 LAYER 2,1  30 PAPER 227  40 CLS   50 PRINT PAPER 0; INK 255;"AoC 2021.09 Smoke Basin         "  60 FOR n=0 TO 7  70 INK 224: PLOT 208+n,7-n: DRAW 7,0: INK 252: DRAW 8,0: INK 28: DRAW 8,0: INK 31: DRAW 8,0  80 NEXT n  90 LAYER PALETTE 0,48, BIN 000000000 100 LAYER PALETTE 0,49, BIN 000000000 110 LAYER PALETTE 0,50, BIN 000000000 120 LAYER PALETTE 0,51, BIN 001001001 130 LAYER PALETTE 0,52, BIN 010010010 140 LAYER PALETTE 0,53, BIN 011011011 150 LAYER PALETTE 0,54, BIN 100100100 160 LAYER PALETTE 0,55, BIN 101101101 170 LAYER PALETTE 0,56, BIN 110110110 180 LAYER PALETTE 0,57, BIN 111111111 190 FOR %n=0 TO 11: READ %c(n): NEXT %n 200 DATA 2,160,162,20,22,180,3,224,231,28,31,252 205 LET left=16: LET top=32 210 INK 57: PLOT left,top: DRAW 101,0: DRAW 0,101: DRAW -101,0: DRAW 0,-101: INK 0 211 PLOT 17*8+4,5*8+4: DRAW 12*8+4,0: DRAW 0,32: DRAW -12*8-4,0: DRAW 0,-32: PRINT AT 5,18;"Risk level"; 212 PLOT 17*8+4,11*8+4: DRAW 12*8+4,0: DRAW 0,32: DRAW -12*8-4,0: DRAW 0,-32: PRINT AT 11,18;"Basin sizes"; 220 READ count 230 FOR %i=top+1 TO top+count 240 READ a$: POKE 40001,a$ 250 FOR %j=left+1 TO left+count 260 PLOT INK % PEEK (39984+j);%j,%i 270 NEXT %j 280 NEXT %i 290 LET %d=0: LET num=0: DIM x(250): DIM y(250) 300 FOR %i=top+1 TO top+count 310 FOR %j=left+1 TO left+count 320 POINT %j,%i TO %x 330 POINT %j-1,%i TO %y: IF %(y<=x) OR (y>57) THEN GO TO %400 340 POINT %j+1,%i TO %y: IF %(y<=x) OR (y>57) THEN GO TO %400 350 POINT %j,%i-1 TO %y: IF %(y<=x) OR (y>57) THEN GO TO %400 360 POINT %j,%i+1 TO %y: IF %(y<=x) OR (y>57) THEN GO TO %400 370 PLOT INK % c( RND (12));%j,%i 380 LET %d=%d+x: PRINT AT 7,19;%d; 390 LET num=num+1: LET x(num)=%j: LET y(num)=%i 400 NEXT %j 410 NEXT %i 420 LET z=1 430 LET %j=x(z): LET %i=y(z) 440 IF %(i=0) OR (j=0) THEN GO TO %510 450 POINT %j,%i TO %c 460 LET %n=0: GO SUB %580 470 LET chg=0 480 IF %n>a(3) THEN LET chg=1: LET %a(3)=%n: IF %n>a(2) THEN LET %a(3)=%a(2): LET %a(2)=%n: IF %n>a(1) THEN LET %a(2)=%a(1): LET %a(1)=%n 490 IF chg THEN LET a1=%a(1): LET a2=%a(2): LET a3=%a(3): PRINT AT 13,19;a1*a2*a3; 500 LET num=num-1: IF num=0 THEN GO TO %530 510 LET z=z+31: IF z>239 THEN LET z=z-239 520 GO TO %430 530 PRINT AT 22,0; 540 STOP  550 POINT %j,%i TO %x 560 IF %(x<48) OR (x>=57) THEN RETURN  570 PLOT INK %c;%j,%i 580 LET %n=%n+1 590 LET %i=%i-1: GO SUB %550: LET %i=%i+1 600 LET %i=%i+1: GO SUB %550: LET %i=%i-1 610 LET %j=%j-1: GO SUB %550: LET %j=%j+1 620 LET %j=%j+1: GO SUB %550: LET %j=%j-1 630 RETURN  640 DATA 100 650 DATA "2448910989999875678989897659865678979789543256899994345698775458934567953123492129654101239876544578" 660 DATA "1237899878988954799878789543976899965679874345678989254987654347895978964934989098793212399775433457" 670 DATA "0146998769877899987665678932987959876789765456789679102996543235789899879899878999986423986543012456" 680 DATA "1235697657656798999523467899898943998899878967994589239865532136996789998789567899876545697652123567" 690 DATA "2345798943234567998434578954769892389998989878913498949974321012345899987678456789987656789763234789" 700 DATA "3456789892176789876557899763456793478987999989201997898765492643456789876562397893498768899874345899" 710 DATA "4567899789238996987678999654567998567896799993219876549876989764567898754321789912989879921965456968" 720 DATA "5679987679349895498989298765978987689945898994345985434989878987678919895632689323977989890987568956" 730 DATA "8798986568956789349795349899899598795434997989576986321097969998789901987544595459866596791998678945" 740 DATA "9987893459967894234696457986789459894329876778987998932356956899899892999665689598754445989899789434" 750 DATA "0296432367899943123789978995492345965798765567898998763569845791998789898976789986853239878799896545" 760 DATA "9987954456997991014567899876569499896899874346789987654698735692989656767897899875432198965679998678" 770 DATA "8598965867896889123458999997678987789978965457893298769798659789976546456989989989544987654588999899" 780 DATA "6459876788945679336589998989789876578967987668962129898999768999876435349878978998765976543456789999" 790 DATA "4345987899434569445678987679894998679656798878953299997899879123984321298767867899879897654597894989" 800 DATA "3257998999856778956799996598943239898945989989967988756799989024595432987553456789989799978689923978" 810 DATA "4769879698767989899999995467894549967959876799899876645689992139989549876442135897898678989789999966" 820 DATA "5698765459988995678998789355789998656799985686798765434578954398878967996321023456789598999999987755" 830 DATA "7987654346999434569876543234567897434988764565689979323589865997657899975432123497993467998789876543" 840 DATA "8998431237894323456998432123456795629876543234569897212678979876545679987563445689532356789567997312" 850 DATA "9876532356965434597987683274587894312985432123498765346789799998678998987654566794310129893499899101" 860 DATA "8997643497897645789998794365698989443987643025789876456995698999889977898765679894321298902989798912" 870 DATA "7898954989989756797899865457899679954599853234899989567896987989998666899876789999762567899878687893" 880 DATA "6669869979879968956967996878934567895899954345689597688999876579987555789989899987653478998766556954" 890 DATA "5456998768767899345756987899026788976798765456993469799789965489876434678999968998764989987654347895" 900 DATA "3346989654656789236345698943987899987899877567894579985697893233984323569998959789985695696543236789" 910 DATA "1259878943345697101235999432198965498999989678965698764556789102398544569987645689996789985432134899" 920 DATA "3498967891257796245679896542019654329678998789877909843545789399987656878999934789987898976543276789" 930 DATA "6597658992969895456998789672199793213567899893998912932125689987898967899687895690198987988765357895" 940 DATA "7976546789899999769887678993987989901459999901259329431034579876899898976576789789979876899876769904" 950 DATA "9875434556799898998766587894696579892398998912345998652149698764789789765465699899865965789999898923" 960 DATA "8976513545689767899857456789985468793987897923459876543498976453665688954324679998754234899219987899" 970 DATA "7684101235678956895940348999874345689876756894567987654987665342434567895213568999765345678998765678" 980 DATA "6543212456789349954321239129863234789765445999698998765696543210123456789101989679876466789987664656" 990 DATA "8754326567895457895494345939952155899854329898989439878987794524254567893216796545987878899876543247"1000 DATA "9865498978976568976989459898743236798765539767678920989699895965675678964345989434499989999987432018"1010 DATA "3976569999797889999978998798654545679876698954567892396543976876799789875999878923234597898997672126"1020 DATA "2988978998659999988667899659765667891987987543467893965432987987899893989888968910123456987898743345"1030 DATA "1099799987545699876456789534986878972399876431238999896541298998997931298776456923499969876549656456"1040 DATA "2345678987656976998967898323987989964459984210267898789732379999876549987654369894988899965439987568"1050 DATA "6456789998997965679878987512399999878998765322348989698975467899987998698765456789976799876598998978"1060 DATA "7987898999999894999989654323467899989549995434559877567896567898999876549896567898875698989987899989"1070 DATA "8998977899986723789399987434689999998732987547698966456797678967899995432997678987654587899976788994"1080 DATA "9999865699865612679209876545789998996510198656987654346999789458989876521398989876543456789765456943"1090 DATA "9898754987654324568913987976798767989321398767898765107899892349876988320129799987674587898654347892"1100 DATA "7769865698965675679894598999897655978992999979999543218999943498765499643234569998775698996543257943"1110 DATA "6543979799898786798789679798987543466789899989987654329898654987654398794355678999898789987964348994"1120 DATA "7656989989689897897679798687795432345698789997898766436789767899863219989496889999919991099876456789"1130 DATA "8967899876568998989578987566679883456997689996519898545678978999642109878989999878909979989987887891"1140 DATA "9899999765459899873467895455598764579876568789423999678989999198759298767678998767898965878998998910"1150 DATA "7667899657398789962345789353459895689985456678945798989896989239898999856589897658987854567999789323"1160 DATA "6556898743235678941034899212567949899893246589657987899765678999986788943476789439876563479989695434"1170 DATA "4345699532124789532128998909698934998763123456969976978954569988675677892125895321999432569878989656"1180 DATA "3212987643045897645237987898989123569954234767898975767895679876544456789234789430987321298767679867"1190 DATA "4324598732126789756746986887679034579874345678997894345689789985432345894345678932965433987654589998"1200 DATA "5435679543235678987899765876567945679765456789876561234899899964321246965467789949878649896543434989"1210 DATA "7689789854346789898998654335478996789896567898765410136799999875210235997878999899999798789762125678"1220 DATA "8799898765457896789987653216345689899987978989654321235678999986471246789999999789654987679981034789"1230 DATA "9989999879878965679998872101234578989598989679865452346799989997564356794598898678943986587892157895"1240 DATA "8779889989989654678898765412345789765329294589976969459894878998675679893987676567892995456943768934"1250 DATA "7656767996799963456789874323556899543210123479897898967943767899986789932976544344569874345894879024"1260 DATA "6545657995679874578998765434667898754453234569789987898912456789197899421298432123498765456789989126"1270 DATA "7437546789998765789769976567788999966568645997654876799101237893298998932987654345569876769894394234"1280 DATA "5321434599899979898659987678899879877679759876543765689292345799999987893598965478978987989995965345"1290 DATA "3210125698789198998748998989997667989899899965432254599989476798789876989679879567999998998789876486"1300 DATA "5421336987699297899656999399876556799998959875421013989878997897698765878989987679989899345678987587"1310 DATA "6533545697578965688967897213987446798976545987532429876569998989549883267896598998876789956989298799"1320 DATA "8689666797678934567898986439898335577996434398643534983456789578934994348987439987654567897892109893"1330 DATA "9789897898989123458909987598789215466889321239658699892345898789323985469999321096543456789943319932"1340 DATA "6999998989292012367919999697692101245678934398799987671236999894319876578998942985432578995399998743"1350 DATA "4589999879349249567898954989789322356789545499989876542369899994301987678967959876301999999987898654"1360 DATA "3567894567998767688967899879896543587897656989778987654456789989212399989456899965219899898976798786"1370 DATA "1678943456789898799456798667999854698998779875667898765867896578993498994343459874398798797545699898"1380 DATA "2399432345999979891345897556789765679879898754556999976788965459789997894212346985498678679786789949"1390 DATA "7488901499899965989456986434999876789567987652345799987899657345699876789101235696597534567997891234"1400 DATA "6567919987678894978967987565678987999479998943456789498986543234598765898913445987694323459899974345"1410 DATA "7678998776576799769899298978899298998567898767567891299197654995799954987896567898983210467789765457"1420 DATA "8989987655465678958789109989962109997679999978979932489098769889987653976789878999874331235679876788"1430 DATA "9899876543234989545678919898743235789789999999989543678969898779976542987991989998765444346789987899"1440 DATA "9789987652129895434569898797654876789999988989999654799457987668894321299890199989976556758998998997"1450 DATA "7689987543019789523498765689967997999899876578998769892239876556789210135689239876598677869767899976"1460 DATA "8579997659198697634989654567899989999798765459999899910198765435698921234568998765439988978956789765"1470 DATA "9989998798987589789877653239988769897659976567899989991987654324567892365889219896589999299349899976"1480 DATA "9997899997632368999965432129878658789543297678999878989998743213678999876792101989678992101298999897"1490 DATA "9876569877521245799876521098965444689910129899999869978999654324567891989895219878989876512347898789"1500 DATA "9876439765430235678965432987654323459891339974987645667899876435698943490994398767899765425456997679"1510 DATA "8987549897641346889976743498743212345789997653498432458987987898789964591989497656789876536569876567"1520 DATA "7698699998656558999989894569954103456899874312397321345696599999899876989878987545798987758998665458"1530 DATA "6569989998767789679994987698763212367956965409986532876789321987902999879767897634567898769876532367"1540 DATA "7469878999979897567893498789878323898949876598987656797893210976799323965458976545778969978998745456"1550 DATA "4359767898989976457965999895989435789432987987698787898964349865988939989569987897989878989899876567"1560 DATA "3298657897693495356899896954297576798743798998789898999878959654567898997689798998997989496798987878"1570 DATA "4196545695432983248999765433129677899654679679895979579989898943459997898795679329456793245987898989"1580 DATA "9989434789545975356789654321098788968995794598984767488998787894567896749896794212399892199876789094"1590 DATA "8976545897656996467899965432569899756989899987673456347898676789688965432987895623988943989665789123"1600 DATA "7987666789769876578999878543457986549878968987542101236987545678999879651099939799877895976554678934"1610 DATA "6598787899878997678995988754567893234569656798763232345965436789999998743237923987656799865443567895"1620 DATA "7429899932989698789684598765689942126989343987654343459876545999987659854446799876545987654321289999"1630 DATA "3212945893994569896543459876796532017893212399765454678989658998776545966567898765434598765410125678"1640 DATA "2101236789876899987432479987897653428943101239876675789998767897654326977878999982123459886531234567"